<!DOCTYPE html>
<html lang="zh-Hant">
<head>
  <meta charset="UTF-8" />
  <title>Arwen é–‹åœ˜è³¼ç‰©</title>
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <link href="https://fonts.googleapis.com/css2?family=Noto+Sans+TC&display=swap" rel="stylesheet">
  <script>
    const deadline = new Date("2025-06-22T23:59:59+08:00");
    if (new Date() > deadline) window.location.href = "../other/timesup.html";
  </script>
  <style>
    @media (max-width: 480px) {
      .info-box { font-size: 13px; padding: 12px; }
      .info-box p, .payment-notice p { line-height: 1.8; margin: 6px 0; }
      .notice-title { font-size: 20px; }
    }
    body { font-family:"Noto Sans TC",sans-serif; background:#f3f3f3; margin:0; padding:0; }
    .product-wrapper { display:flex; justify-content:center; flex-wrap:wrap; gap:40px; }
    .product-card { margin-top:30px; background:#fff; padding:20px; border-radius:10px; border:1.5px solid #ccc; text-align:center; width:250px; }
    .product-card img { width:200px; height:200px; object-fit:cover; border-radius:8px; }
    .product-title { font-size:20px; font-weight:bold; margin:20px 0; }
    .member-row { display:flex; justify-content:center; align-items:center; margin-top:10px; gap:10px; }
    .member-name { width:30px; }
    .qty-btn { width:30px; height:30px; background:#d7a9f9; border:none; border-radius:5px; color:#fff; font-size:18px; cursor:pointer; }
    .qty-input {width: 40px;height: 30px;text-align: center;font-size: 16px;line-height: 30px;  /* èˆ‡ height ç›¸åŒï¼Œé”æˆå‚ç›´ç½®ä¸­ */border: 1px solid #ccc;border-radius: 5px;pointer-events: none;}
    .qty-input::-webkit-inner-spin-button,
    .qty-input::-webkit-outer-spin-button { -webkit-appearance:none; margin:0; }

    .total { font-size:25px; font-weight:bold; text-align:center; margin:30px 0; }
    .submit-btn { background:linear-gradient(45deg,#6e46ae,#d7a9f9); color:#fff; font-size:16px; padding:10px 30px; border:none; border-radius:8px; cursor:pointer; margin-top:20px; }
    #order-summary-text { font-weight:300; font-size:16px; line-height:1.6; text-align:center; }
    #checkout-section { margin-top:30px; padding-top:20px; border-top:2px dashed #ccc; }
    .payment-notice { background:#a798bd; color:#fff; padding:5px; border-radius:10px; text-align:center; line-height:0.8; margin-bottom:30px; font-size:15px; }
    .form-group { margin-top:15px; }
    .form-group input,.form-group select { width:100%; padding:10px; border:1px solid #ccc; border-radius:5px; margin-top:5px; }
    .invalid { border:2px solid #e74c3c; background:#fff0f0; }
    .error-message { font-size:13px; color:#e74c3c; margin-top:5px; display:none; }
  </style>
</head>
<body>

  <!-- æ³¨æ„äº‹é … -->
  <div class="info-box" style="background:#fff6e5; border-left:5px solid #f39c12; margin:20px; border-radius:8px; padding:15px 20px;">
    <p class="notice-title" style="margin:0 0 10px; font-weight:bold; display:flex; align-items:center;">
      <span style="font-size:18px; margin-right:6px;">âš ï¸</span>æ³¨æ„äº‹é …</p>
     <p style="margin:10px 0;">è¯ç´caseå–®å¼µéš¨æ©Ÿèˆ‡ä¸€å¥—å¡æ± ç¨æœ‰ä¸åŒï¼Œè«‹æ³¨æ„é¸æ“‡</p>
     <p style="margin:10px 0;">æ¯æ»¿åå¼µå°±æœƒä¸‹å–®ä¸€æ¬¡ï¼Œä½†ä»æœ‰æ–·è²¨å¯èƒ½æ€§</p>
     <p style="margin:10px 0;">æ–·è²¨æœƒé€€æ¬¾ï¼Œä½†æ‚¨è½‰çµ¦æˆ‘æ™‚ç”¢ç”Ÿçš„è·¨è¡Œæ‰‹çºŒè²»æˆ‘æ–¹ä¸æ‰¿æ“”</p>
     <p style="margin:10px 0;">æ­¤æ¬¡ç‰¹å…¸å¡è‹¥è³¼è²·è‡³è·Ÿå¡æ± æ•¸é‡ä¸€æ¨£æ™‚æœƒå„ªå…ˆé…å¥—(ä»ä¸ä¿è­‰ï¼Œå…·é«”çœ‹å®˜æ–¹çµ¦)</p>
     <p style="margin:10px 0;">å…¶é¤˜å°‡ç‚ºç›²åŒ…éš¨æ©Ÿå‡ºè²¨</p>
     <p style="margin:10px 0;">éš¨æ©Ÿä¸€è³¼è²·18æ™‚å„ªå…ˆé…å¥—ï¼Œä¸€å¥—æ»¿5æ™‚å„ªå…ˆé…å¥—</p>
     <p style="margin:10px 0;">å¡æ± ä¹‹é–“ä¸æ··åˆï¼Œä¾‹å¦‚è³¼è²·ä¸€å¥—5+éš¨æ©Ÿä¸€8æ™‚ä¸ä¿è­‰8å–®äºº+10å¤šäººï¼Œæœ‰å¯èƒ½æ˜¯4å–®äºº+14å¤šäººæˆ–å…¶ä»–</p>
  </div>

  <!-- å•†å“å€ -->
  <div class="product-wrapper">
    <div class="product-card" data-price="1000">
      <img src="../image/w/c.webp" alt="è¯ç´caseéš¨æ©Ÿä¸€">
      <div class="product-title">è¯ç´caseéš¨æ©Ÿä¸€ - $1000</div>
      <p>å¡æ± : 18 ç¨® - å–®äºº 8 / å¤šäºº 10</p>
      <div class="member-row" data-member="ä¸€">
        <span class="member-name">ä¸€</span>
        <button class="qty-btn" onclick="updateQty(this,-1)">-</button>
        <input type="number" class="qty-input" value="0" readonly inputmode="none">
        <button class="qty-btn" onclick="updateQty(this,1)">+</button>
      </div>
    </div>

    <div class="product-card" data-price="1000">
      <img src="../image/w/c.webp" alt="è¯ç´caseä¸€å¥—å…©å¼µ">
      <div class="product-title">è¯ç´caseä¸€å¥—å…©å¼µ - $2000</div>
      <p>å¡æ± : 10 ç¨® - å¤šäºº 10</p>
      <div class="member-row" data-member="å¥—">
        <span class="member-name">å¥—</span>
        <button class="qty-btn" onclick="updateQty(this,-1)">-</button>
        <input type="number" class="qty-input" value="0" readonly inputmode="none">
        <button class="qty-btn" onclick="updateQty(this,1)">+</button>
      </div>
    </div>
  </div>

  <div class="total">ç¸½é‡‘é¡ï¼š<span id="total-price">$0</span></div>
  <div style="text-align:center;"><button class="submit-btn" onclick="showCheckout()">çµå¸³</button></div>

  <!-- çµå¸³å€ -->
  <div id="checkout-section" style="display:none;">
    <div class="total" id="order-summary-text"></div>

    <div class="payment-notice">
      <p>ğŸ’°ä»˜æ¬¾é ˆçŸ¥ï¼šåŒ¯æ¬¾/ç„¡å¡å¸³è™Ÿï¼š</p>
      <p>è«‹å‹¿å‚™è¨»ä»»ä½•å­—ç¬¦ï¼æœƒå°ä¸åˆ°å¸³</p>
      <p>ï¼ˆ822ï¼‰901566584648</p>
      <p>è«‹å…ˆå®Œæˆä»˜æ¬¾å¾Œå†é€å‡ºè¡¨å–®</p>
      <p>è‹¥æœªæ”¶åˆ°æ¬¾é …ï¼Œå°‡ä¸åˆ—å…¥æ­¤æ¬¡è¨‚å–®ã€‚</p>
      <p>ç„¡å¡ï¼šå¡«å¯«ç¢ºåˆ‡æ—¥æœŸæ™‚é–“ä¸¦ç„¡å¡è‡³ç™¾ä½æ•¸ï¼Œå…¶é¤˜äºŒè£œ</p>
    </div>

    <div class="form-group">
      <label for="email">*Gmail ä¿¡ç®±ï¼ˆç³»çµ±è‡ªå‹•è£œä¸Šï¼‰</label>
      <input type="text" id="email" placeholder="xxxxx" required oninput="validateEmail(this)">
      <div id="email-error" class="error-message">è«‹è¼¸å…¥æ­£ç¢ºçš„ Gmail</div>
    </div>
    <div class="form-group">
      <label for="name">*ç¤¾ç¾¤å…§æ‚¨çš„å§“å</label>
      <input type="text" id="name" required>
    </div>
    <div class="form-group">
      <label for="amount">*åŒ¯æ¬¾/ç„¡å¡é‡‘é¡</label>
      <input type="text" id="amount" required oninput="validateAmount(this)">
      <div id="amount-error" class="error-message">åªèƒ½å¡«å¯«æ•¸å­—ï¼Œæœ€å¤šå…©ä½å°æ•¸</div>
    </div>
    <div class="form-group">
      <label for="bank">åŒ¯æ¬¾éŠ€è¡Œ + æœ«äº”ç¢¼</label>
      <input type="text" id="bank" required>
    </div>
    <div class="form-group">
      <label for="time">ç„¡å¡æ™‚é–“</label>
      <input type="text" id="time">
    </div>
    <div class="form-group">
      <label for="agree">*æ˜¯å¦åŒæ„è³¼è²·é ˆçŸ¥</label>
      <select id="agree" required>
        <option value="">è«‹é¸æ“‡</option>
        <option value="æ˜¯">æ˜¯</option>
      </select>
    </div>
    <div style="text-align:center;"><button class="submit-btn" onclick="submitOrder()">é€å‡ºè¨‚å–®</button></div>
  </div>

<!-- ================= JS ================= -->
<script>
  /* æ•¸é‡åŠ æ¸›èˆ‡ç¸½é‡‘é¡ */
  function updateQty(btn, delta) {
    const inp = btn.parentElement.querySelector('input');
    let q = parseInt(inp.value) + delta;
    if (q < 0) q = 0;
    inp.value = q;
    updateTotal();
  }
  function updateTotal() {
    let t = 0;
    document.querySelectorAll('.product-card').forEach(card => {
      const price = parseInt(card.dataset.price);
      card.querySelectorAll('.qty-input').forEach(i => {
        t += price * parseInt(i.value);
      });
    });
    document.getElementById('total-price').innerText = `$${t}`;
  }

  /* é¡¯ç¤ºçµå¸³æ˜ç´° */
  function showCheckout() {
    const summary = [];
    document.querySelectorAll('.product-card').forEach(card => {
      const title = card.querySelector('.product-title').innerText;
      const lines = [];
      card.querySelectorAll('.member-row').forEach(r => {
        const m = r.dataset.member;
        const q = parseInt(r.querySelector('input').value);
        if (q > 0) lines.push(`${m} x${q}`);
      });
      if (lines.length) summary.push(`${title}<br>${lines.join('<br>')}`);
    });
    if (!summary.length) {
      alert('è«‹è‡³å°‘é¸æ“‡ä¸€é …å•†å“å†çµå¸³ï¼');
      return;
    }
    document.getElementById('order-summary-text').innerHTML =
      `<strong>æ‚¨çš„è³¼è²·æ˜ç´°ï¼š</strong><br><br>${summary.join('<br><br>')}`;
    document.getElementById('checkout-section').style.display = 'block';
    window.scrollTo({ top: document.body.scrollHeight, behavior: 'smooth' });
  }

  /* -------- å³æ™‚é©—è­‰ -------- */
  function validateEmail(input) {
    const val = input.value.trim();
    const err = document.getElementById('email-error');
    if (val === '' || !val.includes('@')) {
      input.classList.remove('invalid');
      err.style.display = 'none';
      return;
    }
    if (!val.endsWith('@gmail.com')) {
      input.classList.add('invalid');
      err.style.display = 'block';
    } else {
      input.classList.remove('invalid');
      err.style.display = 'none';
    }
  }
  function validateAmount(input) {
    const v = input.value.trim();
    const err = document.getElementById('amount-error');
    if (v === '' || /^\d+(\.\d{0,2})?$/.test(v)) {
      input.classList.remove('invalid');
      err.style.display = 'none';
    } else {
      input.classList.add('invalid');
      err.style.display = 'block';
    }
  }

  /* é€å‡ºè¨‚å–® */
  function submitOrder() {
    /* Email è£œ @gmail.com */
    let emailInput = document.getElementById('email').value.trim();
    if (!emailInput.includes('@')) emailInput += '@gmail.com';
    document.getElementById('email').value = emailInput;

    /* æœ€çµ‚é©—è­‰ */
    if (!emailInput.endsWith('@gmail.com')) {
      alert('åªæ¥å— Gmail å¸³è™Ÿï¼Œè«‹é‡æ–°ç¢ºèªæ‚¨çš„ Emailï¼');
      return;
    }
    const name   = document.getElementById('name').value.trim();
    const amount = document.getElementById('amount').value.trim();
    const bank   = document.getElementById('bank').value.trim();
    const time   = document.getElementById('time').value.trim();
    const agree  = document.getElementById('agree').value;

    if (!emailInput || !name || !amount || !agree) {
      alert('è«‹å¡«å¯«æ‰€æœ‰å¿…å¡«æ¬„ä½ï¼');
      return;
    }
    if (!/^\d+(\.\d{0,2})?$/.test(amount)) {
      alert('åŒ¯æ¬¾é‡‘é¡æ ¼å¼éŒ¯èª¤ï¼Œåªèƒ½å¡«å¯«æ•¸å­—ï¼');
      return;
    }

    /* æ•´ç†å•†å“æ•¸é‡ */
    const qtys = {};
    document.querySelectorAll('.member-row').forEach(r => {
      const m = r.dataset.member;
      const q = parseInt(r.querySelector('input').value);
      qtys[m] = (qtys[m] || 0) + q;
    });
    const total = document.getElementById('total-price').innerText.replace('$', '');

    /* âš ï¸ ä¸‹é¢å…©å€‹ entry ID è«‹æ›¿æ›æˆ Google è¡¨å–®å¯¦éš›æ¬„ä½ ID */
    const postData = {
      'entry.1900636822': qtys['ä¸€'],  // è¯ç´caseéš¨æ©Ÿä¸€
      'entry.1345279261': qtys['å¥—'],  // è¯ç´caseä¸€å¥—å…©å¼µ
      'entry.2051250517': total,
      'entry.629965707': emailInput,
      'entry.548372524': name,
      'entry.1925502819': amount,
      'entry.123200789': bank,
      'entry.705928444': time,
      'entry.2042996501': agree
    };

    fetch('https://docs.google.com/forms/d/1m865ZTjsh6a1ItHgc2d0mWNP12dzBNPtoJeTtVbjkMY/formResponse', {
      method: 'POST',
      mode: 'no-cors',
      headers: { 'Content-Type': 'application/x-www-form-urlencoded' },
      body: new URLSearchParams(postData).toString()
    })
      .then(() => { window.location.href = '../other/done.html'; })
      .catch(() => { window.location.href = '../other/error.html'; });
  }

  /* è‡ªå‹•å¸¶å…¥ & å³æ™‚å„²å­˜ localStorage */
  window.addEventListener('DOMContentLoaded', () => {
    ['email', 'name', 'bank'].forEach(id => {
      document.getElementById(id).value =
        localStorage.getItem('saved' + id.charAt(0).toUpperCase() + id.slice(1)) || '';
    });
  });
  ['email', 'name', 'bank'].forEach(id => {
    const input = document.getElementById(id);
    if (input) {
      input.addEventListener('input', () => {
        localStorage.setItem('saved' + id.charAt(0).toUpperCase() + id.slice(1), input.value);
      });
    }
  });
</script>
</body>
</html>
